var AuthorDraggableElement=function(){"use strict";window.hasOwnProperty("AuthorBaseElement")||(console.error('[ERROR] <author-draggable> Required dependency "AuthorBaseElement" not found.'),console.info("AuthorBaseElement is available at https://github.com/author-elements/base")),function(){let e=Array.from(new Set([])).filter(e=>!customElements.get(e));e.length>0&&(console.error(`[ERROR] <author-draggable> Required dependenc${1!==e.length?"ies":"y"} not found: ${e.map(e=>`<${e}>`).join(", ").replace(", "+e[e.length-1]," and "+e[e.length-1])}`),e.forEach((e,t)=>console.info(`${t+1}. <${e}> is available at ${"https://github.com/author-elements/draggable".replace("draggable",e.replace("author-",""))}`)))}();class e extends(AuthorBaseElement(HTMLElement)){constructor(){super('<template><style>@charset "UTF-8"; :host{display:flex;cursor:move}:host *,:host :after,:host :before{box-sizing:border-box}:host([clone][dragging]){contain:content!important;position:fixed!important;z-index:2147483647!important;will-change:left,top}author-draggable{display:flex;cursor:move}author-draggable *,author-draggable :after,author-draggable :before{box-sizing:border-box}author-draggable[clone][dragging]{contain:content!important;position:fixed!important;z-index:2147483647!important;will-change:left,top}</style><slot></slot></template>'),this.UTIL.defineAttributes({direction:{default:null},disabled:{default:!1},free:{default:!1},"max-drag-distance":{default:null},"min-drag-distance":{default:null},type:{default:null}}),this.UTIL.defineProperties({acceptedConstraintKeys:{private:!0,readonly:!0,default:["x","y","up","right","down","left"]},canDrop:{private:!0,default:!1},clone:{private:!0,default:null},constraints:{private:!0,readonly:!0,get:()=>this.direction?this.direction.replace(/\s+/g," ").trim().split(" "):null},data:{default:null},dimensions:{private:!0,readonly:!0,get:()=>this.getBoundingClientRect()},dragArea:{private:!0,readonly:!0,get:()=>{let e=document.querySelectorAll("author-dragarea");for(let t of e)if(t.contains(this))return t;return document.body}},dragIsActive:{private:!0,default:!1},dropTargets:{private:!0,default:null},initialPosition:{private:!0,default:null},initialTimestamp:{private:!0,default:null},pointerEventsSupported:{private:!0,readonly:!0,default:void 0!==window.PointerEvent},pointerOffset:{private:!0,default:null},userIsTouching:{private:!0,default:!1},types:{private:!0,readonly:!0,get:()=>this.type?this.type.replace(/\s+/g," ").trim().split(" "):null}}),this.UTIL.definePrivateMethods({forwardEvent:(e,t,i={},n=this)=>{e.preventDefault(),i.originalEvent=e,this.PRIVATE.pointerEventsSupported||this.emit(t,i,n)},getComputedStylesCssText:e=>{let t=window.getComputedStyle(e),i=[];if(""!==t.cssText)return t.cssText;for(let e in t)"string"==typeof t[e]&&i.push(`${e}: ${t[e]}`);return i.join("; ")},handshakeAcceptedHandler:e=>{let{dropTarget:t}=e.detail;this.PRIVATE.dropTargets.push(t),t.on("drop.allow",e=>this.PRIVATE.canDrop=!0),t.on("drop.deny",e=>this.PRIVATE.canDrop=!1)},initializeClone:()=>{this.setAttribute("dragging",""),this.PRIVATE.clone=this.cloneNode(!0),this.PRIVATE.synchronizeStyles(),this.PRIVATE.clone.sourceElement=this,this.removeAttribute("dragging"),this.PRIVATE.clone.setAttribute("clone",""),document.body.appendChild(this.PRIVATE.clone)},pointerupHandler:e=>{let t=new CustomEvent("drag.end",this.PRIVATE.getEventData(e,{drag:{distance:this.PRIVATE.getDragDistance(e),duration:e.timeStamp-this.PRIVATE.initialTimestamp},position:this.PRIVATE.getPointerPosition(e,!1)}));this.emit(t),this.PRIVATE.reset()},mouseupHandler:e=>{this.PRIVATE.forwardEvent(e,"pointerup",{},document.body)},touchendHandler:e=>{},applyBodyListeners:()=>{document.body.addEventListener("pointerup",this.PRIVATE.pointerupHandler),document.body.addEventListener("mouseup",this.PRIVATE.mouseupHandler),document.body.addEventListener("touchend",this.PRIVATE.touchendHandler)},removeBodyListeners:()=>{document.body.removeEventListener("pointerup",this.PRIVATE.pointerupHandler),document.body.removeEventListener("mouseup",this.PRIVATE.mouseupHandler),document.body.removeEventListener("touchend",this.PRIVATE.touchendHandler),document.body.removeEventListener(this.PRIVATE.pointerEventsSupported?"pointermove":"mousemove",this.PRIVATE.pointerMoveHandler)},initiateDrag:()=>{this.PRIVATE.applyBodyListeners(),this.setAttribute(this.free?"dragging":"ghost",""),this.PRIVATE.dragIsActive=!0},getRelativePointerPosition:(e,t,i,n)=>{let o=e-i,r=t-n;return{x:i,y:n,top:{px:n,pct:this.UTIL.getPercentageDecimal(n,t)},right:{px:o,pct:this.UTIL.getPercentageDecimal(o,e)},bottom:{px:r,pct:this.UTIL.getPercentageDecimal(r,t)},left:{px:i,pct:this.UTIL.getPercentageDecimal(i,e)}}},getPercentageDecimal:(e,t,i=null)=>{let n=e/t;return n<0?0:null!==i?n.toFixed(i):n},getPointerPosition:(e,t=!0,i=!0,n=!0)=>{let o={};return t&&(o.offset=this.PRIVATE.getRelativePointerPosition(this.offsetWidth,this.offsetHeight,e.offsetX,e.offsetY)),i&&(o.client=this.PRIVATE.getRelativePointerPosition(document.documentElement.clientWidth,document.documentElement.clientHeight,e.clientX,e.clientY)),n&&(o.document=this.PRIVATE.getRelativePointerPosition(document.documentElement.scrollWidth,document.documentElement.scrollHeight,e.pageX,e.pageY)),o},getEventData:(e,t={})=>{let i={cancelable:!0,composed:!0,detail:Object.assign({},{altKey:e.altKey,ctrlKey:e.ctrlKey,metaKey:e.metaKey,shiftKey:e.shiftKey,types:this.PRIVATE.types},t)};return Object.defineProperty(i.detail,"data",{set:e=>this.data=e,get:()=>this.data}),i},pointerMoveHandler:e=>{if(!this.PRIVATE.dragIsActive){this.free||this.PRIVATE.initializeClone();let t=new CustomEvent("drag.start",this.PRIVATE.getEventData(e,{position:this.PRIVATE.getPointerPosition(e)}));if(this.emit(t),t.defaultPrevented)return;this.PRIVATE.initiateDrag()}let t=new CustomEvent("drag",this.PRIVATE.getEventData(e,{canDrop:this.PRIVATE.canDrop,drag:{distance:this.PRIVATE.getDragDistance(e),duration:e.timeStamp-this.PRIVATE.initialTimestamp},position:this.PRIVATE.getPointerPosition(e,!1)}));this.emit(t),t.defaultPrevented||this.PRIVATE.updatePosition(e)},getDragDistance:e=>({x:Math.abs(this.PRIVATE.initialPosition.x-e.pageX),y:Math.abs(this.PRIVATE.initialPosition.y-e.pageY)}),reset:()=>{this.free?this.removeAttribute("dragging"):(this.removeAttribute("ghost"),null!==this.PRIVATE.clone&&(document.body.removeChild(this.PRIVATE.clone),this.PRIVATE.clone=null)),this.PRIVATE.dragIsActive=!1,this.PRIVATE.pointerOffset=null,this.PRIVATE.removeBodyListeners(),this.PRIVATE.dropTargets=null,this.PRIVATE.initialPosition=null,this.PRIVATE.initialTimestamp=null},storeDropTargets:()=>{this.PRIVATE.dropTargets=[];let e=document.querySelectorAll("author-droptarget");this.on("handshake.accepted",this.PRIVATE.handshakeAcceptedHandler);for(let t of e)this.emit("handshake.offered",{draggable:this,types:this.PRIVATE.types},t);this.off("handshake.accepted",this.PRIVATE.handshakeHandler)},synchronizeStyles:()=>{let{clone:e,getComputedStylesCssText:t}=this.PRIVATE;e.style.cssText=t(this);let i=this.getElementsByTagName("*"),n=e.getElementsByTagName("*");if(i.length>0)for(let e=0;e<i.length;e++)n[e].style.cssText=t(i[e])},updatePosition:e=>{let{clone:t,dimensions:i,originalCoordinates:n,pointerOffset:o}=this.PRIVATE,r={x:e.clientX-o.x,y:e.clientY-o.y};if(this.free)return r={x:r.x-(n.x-window.scrollX),y:r.y-(n.y-window.scrollY)},this.UTIL.setStyleProperty("dragging","transform",`translate(${r.x}px, ${r.y}px)`);t.UTIL.setStyleProperties("dragging",[{name:"left",value:`${r.x}px`,important:!0},{name:"top",value:`${r.y}px`,important:!0}])}}),this.UTIL.registerListeners(this,{"attribute.changed":e=>{let{attribute:t,newValue:i,oldValue:n}=e.detail;switch(t){case"free":this.free||this.UTIL.removeStyleProperty("dragging","transform")}},connected:()=>{this.UTIL.insertStyleRule("dragging",":host {}"),this.emit("author-draggable.connected",{draggable:this},window)},mousedown:e=>{if(this.PRIVATE.userIsTouching)return e.preventDefault();this.PRIVATE.forwardEvent(e,"pointerdown")},touchstart:e=>{e.preventDefault(),this.PRIVATE.userIsTouching=!0,this.PRIVATE.forwardEvent(e,"pointerdown")},pointerup:e=>{this.PRIVATE.reset()},pointerdown:e=>{let t={};this.PRIVATE.initialTimestamp=e.timeStamp,e instanceof CustomEvent?(t.x=e.detail.originalEvent.clientX,t.y=e.detail.originalEvent.clientY):(t.x=e.clientX,t.y=e.clientY),this.PRIVATE.initialPosition={x:t.x,y:t.y},this.PRIVATE.pointerOffset={x:t.x-this.PRIVATE.dimensions.left,y:t.y-this.PRIVATE.dimensions.top},document.body.addEventListener(this.PRIVATE.pointerEventsSupported?"pointermove":"mousemove",this.PRIVATE.pointerMoveHandler),this.PRIVATE.storeDropTargets()},rendered:()=>{this.UTIL.defineProperty("originalCoordinates",{private:!0,readonly:!0,default:{x:this.PRIVATE.dimensions.left+window.scrollX,y:this.PRIVATE.dimensions.top+window.scrollY}})}})}static get observedAttributes(){return["direction","disabled","free","min-drag-distance","max-drag-distance","type"]}}return customElements.define("author-draggable",e),e}();
//# sourceMappingURL=author-draggable.min.js.map
