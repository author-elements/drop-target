{"version":3,"file":"author-drop-target.es5.js","sources":["../src/element.js"],"sourcesContent":["class AuthorDropTargetElement extends AuthorBaseElement(HTMLElement) {\n  constructor () {\n    super(`{{TEMPLATE-STRING}}`)\n\n    this.UTIL.defineAttributes({\n      accepts: {\n        default: '*'\n      },\n\n      mustMatch: {\n        default: 1\n      },\n\n      over: {\n        default: false\n      },\n\n      sortable: {\n        default: false\n      },\n\n      types: {\n        default: null\n      }\n    })\n\n    this.UTIL.defineProperties({\n      acceptedTypes: {\n        private: true,\n        readonly: true,\n        get: () => {\n          if (this.accepts === null) {\n            return null\n          }\n\n          return this.accepts.replace(/\\s+/g,' ').trim().split(' ')\n        }\n      },\n\n      dimensions: {\n        private: true,\n        readonly: true,\n        get: () => this.getBoundingClientRect()\n      },\n\n      draggable: {\n        private: true,\n        default: null\n      },\n\n      lastPointerClientPosition: {\n        private: true,\n        default: null\n      },\n\n      offsetPointerPosition: {\n        private: true,\n        default: null\n      },\n\n      willAcceptDrop: {\n        private: true,\n        default: false\n      }\n    })\n\n    this.UTIL.definePrivateMethods({\n      applyDragHandlers: () => {\n        let { draggable } = this.PRIVATE\n\n        draggable.on('drag', this.PRIVATE.dragHandler)\n        draggable.on('drag.end', this.PRIVATE.dragendHandler)\n      },\n\n      getEventData: (evt, props = {}) => ({\n        cancelable: true,\n        composed: true,\n\n        detail: Object.assign({}, {\n          acceptedTypes: this.PRIVATE.acceptedTypes,\n          data: this.PRIVATE.draggable.data,\n          willAcceptDrop: this.PRIVATE.willAcceptDrop,\n          position: this.PRIVATE.getPointerPosition(evt),\n          source: this.PRIVATE.draggable\n        }, props)\n      }),\n\n      getPointerPosition: evt => {\n        let relative = {\n          height: this.offsetHeight,\n          width: this.offsetWidth\n        }\n\n        let left = evt.offsetX || this.PRIVATE.offsetPointerPosition.x\n        let top = evt.offsetY || this.PRIVATE.offsetPointerPosition.y\n        let right = relative.width - left\n        let bottom = relative.height - top\n\n        let position = {\n          x: left,\n          y: top,\n\n          top: {\n            px: top,\n            pct: this.UTIL.getPercentageDecimal(top, relative.height)\n          },\n\n          right: {\n            px: right,\n            pct: this.UTIL.getPercentageDecimal(right, relative.width)\n          },\n\n          bottom: {\n            px: bottom,\n            pct: this.UTIL.getPercentageDecimal(bottom, relative.height)\n          },\n\n          left: {\n            px: left,\n            pct: this.UTIL.getPercentageDecimal(left, relative.width)\n          }\n        }\n\n        return Object.assign({}, position, {\n          quadrant: this.PRIVATE.getDropQuadrant(position)\n        })\n      },\n\n      dragHandler: evt => {\n        let { draggable, dimensions, lastPointerClientPosition } = this.PRIVATE\n        let { client } = evt.detail.position\n        let isEntering = null\n        let isLeaving = null\n\n        let isOver = {\n          x: client.x >= dimensions.left && client.x <= dimensions.right,\n          y: client.y >= dimensions.top && client.y <= dimensions.bottom\n        }\n\n        if (lastPointerClientPosition !== null) {\n          isEntering = {\n            top: isOver.x && lastPointerClientPosition.y <= dimensions.top && client.y > dimensions.top,\n            right: isOver.y && lastPointerClientPosition.x >= dimensions.right && client.x < dimensions.right,\n            bottom: isOver.x && lastPointerClientPosition.y >= dimensions.bottom && client.y < dimensions.bottom,\n            left: isOver.y && lastPointerClientPosition.x <= dimensions.left && client.x > dimensions.left\n          }\n\n          isLeaving = {\n            top: isOver.x && lastPointerClientPosition.y >= dimensions.top && client.y < dimensions.top,\n            right: isOver.y && lastPointerClientPosition.x <= dimensions.right && client.x > dimensions.right,\n            bottom: isOver.x && lastPointerClientPosition.y <= dimensions.bottom && client.y > dimensions.bottom,\n            left: isOver.y && lastPointerClientPosition.x >= dimensions.left && client.x < dimensions.left\n          }\n        }\n\n        this.PRIVATE.offsetPointerPosition = {\n          x: client.x - dimensions.left,\n          y: client.y - dimensions.top\n        }\n\n        let isParent = this.contains(draggable)\n\n        if (isEntering !== null && Object.values(isEntering).some(Boolean)) {\n          let dragenterEvent = new CustomEvent('drag.enter', this.PRIVATE.getEventData(evt))\n          this.emit(dragenterEvent)\n\n          if (isParent) {\n            this.over = false\n            this.PRIVATE.willAcceptDrop = false\n          } else {\n            if (!dragenterEvent.defaultPrevented) {\n              this.emit(`drop.allow`)\n              this.over = true\n              this.PRIVATE.willAcceptDrop = true\n            }\n          }\n        }\n\n        if (isOver.x && isOver.y) {\n          if (!this.over) {\n            this.over = !isParent\n            this.emit(`drop.${isParent ? 'deny' : 'allow'}`, {})\n          }\n\n          this.emit(new CustomEvent('drag.over', this.PRIVATE.getEventData(evt)))\n        }\n\n        if (isLeaving !== null && Object.values(isLeaving).some(Boolean)) {\n          this.over = false\n          this.emit('drop.deny', {})\n          this.emit(new CustomEvent('drag.leave', this.PRIVATE.getEventData(evt)))\n        }\n\n        this.PRIVATE.lastPointerClientPosition = {\n          x: client.x,\n          y: client.y\n        }\n      },\n\n      getDropQuadrant: position => {\n        let x = 'left'\n        let y = 'top'\n\n        if (position.left.pct === .5) {\n          x = 'center'\n        }\n\n        if (position.left.pct > .5) {\n          x = 'right'\n        }\n\n        if (position.top.pct === .5) {\n          y = 'center'\n        }\n\n        if (position.top.pct > .5) {\n          y = 'bottom'\n        }\n\n        return `${y} ${x}`\n      },\n\n      dragendHandler: evt => {\n        let dropEvent = new CustomEvent('drop', this.PRIVATE.getEventData(evt))\n\n        if (this.over) {\n          this.emit(dropEvent)\n        }\n\n        if (dropEvent.defaultPrevented) {\n          console.log('PREVENTED');\n        }\n\n        this.PRIVATE.removeDragHandlers()\n        this.over = false\n        this.offsetPointerPosition = null\n      },\n\n      removeDragHandlers: () => {\n        this.PRIVATE.draggable.off('drag', this.PRIVATE.dragHandler)\n        this.PRIVATE.draggable.off('drag.end', this.PRIVATE.dragendHandler)\n      }\n    })\n\n    this.UTIL.registerListeners(this, {\n      'handshake.offered': evt => {\n        let { draggable, types } = evt.detail\n        let reject = false\n\n        switch (this.mustMatch) {\n          case 'all':\n          case '*':\n            if (!this.PRIVATE.acceptedTypes.every(type => types.includes(type))) {\n              reject = true\n            }\n            break\n\n          default:\n            if (!(this.PRIVATE.acceptedTypes.filter(type => types.includes(type)).length >= this.mustMatch)) {\n              reject = true\n            }\n        }\n\n        if (reject) {\n          return\n        }\n\n        this.emit('handshake.accepted', { dropTarget: this }, draggable)\n\n        this.PRIVATE.draggable = draggable\n        this.PRIVATE.applyDragHandlers()\n      }\n    })\n  }\n\n  static get observedAttributes () {\n    return ['accepts', 'sortable']\n  }\n}\n\ncustomElements.define('author-drop-target', AuthorDropTargetElement)\n\nexport default AuthorDropTargetElement\n"],"names":["AuthorDropTargetElement","UTIL","defineAttributes","accepts","default","mustMatch","over","sortable","types","defineProperties","acceptedTypes","private","readonly","get","replace","trim","split","dimensions","getBoundingClientRect","draggable","lastPointerClientPosition","offsetPointerPosition","willAcceptDrop","definePrivateMethods","applyDragHandlers","PRIVATE","on","dragHandler","dragendHandler","getEventData","evt","props","cancelable","composed","detail","Object","assign","data","position","getPointerPosition","source","relative","height","offsetHeight","width","offsetWidth","left","offsetX","x","top","offsetY","y","right","bottom","px","pct","getPercentageDecimal","quadrant","getDropQuadrant","client","isEntering","isLeaving","isOver","isParent","contains","values","some","Boolean","dragenterEvent","CustomEvent","emit","defaultPrevented","dropEvent","console","log","removeDragHandlers","off","registerListeners","reject","every","type","includes","filter","length","dropTarget","AuthorBaseElement","HTMLElement","customElements","define"],"mappings":"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"}