var AuthorDropTargetElement=function(){"use strict";window.hasOwnProperty("AuthorBaseElement")||(console.error('[ERROR] <author-drop-target> Required dependency "AuthorBaseElement" not found.'),console.info("AuthorBaseElement is available at https://github.com/author-elements/base")),function(){let t=Array.from(new Set([])).filter(t=>!customElements.get(t));t.length>0&&(console.error(`[ERROR] <author-drop-target> Required dependenc${1!==t.length?"ies":"y"} not found: ${t.map(t=>`<${t}>`).join(", ").replace(", "+t[t.length-1]," and "+t[t.length-1])}`),t.forEach((t,e)=>console.info(`${e+1}. <${t}> is available at ${"https://github.com/author-elements/drop-target".replace("drop-target",t.replace("author-",""))}`)))}();class t extends(AuthorBaseElement(HTMLElement)){constructor(){super('<template><style>@charset "UTF-8"; :host *,:host :after,:host :before{box-sizing:border-box}author-drop-target *,author-drop-target :after,author-drop-target :before{box-sizing:border-box}</style><slot></slot></template>'),this.UTIL.defineAttributes({accepts:{default:"*"},mustMatch:{default:1},over:{default:!1},sortable:{default:!1},types:{default:null}}),this.UTIL.defineProperties({acceptedTypes:{private:!0,readonly:!0,get:()=>null===this.accepts?null:this.accepts.replace(/\s+/g," ").trim().split(" ")},dimensions:{private:!0,readonly:!0,get:()=>this.getBoundingClientRect()},draggable:{private:!0,default:null},lastPointerClientPosition:{private:!0,default:null},offsetPointerPosition:{private:!0,default:null},willAcceptDrop:{private:!0,default:!1}}),this.UTIL.definePrivateMethods({applyDragHandlers:()=>{let{draggable:t}=this.PRIVATE;t.on("drag",this.PRIVATE.dragHandler),t.on("drag.end",this.PRIVATE.dragendHandler)},getEventData:(t,e={})=>({cancelable:!0,composed:!0,detail:Object.assign({},{acceptedTypes:this.PRIVATE.acceptedTypes,data:this.PRIVATE.draggable.data,willAcceptDrop:this.PRIVATE.willAcceptDrop,position:this.PRIVATE.getPointerPosition(t),source:this.PRIVATE.draggable},e)}),getPointerPosition:t=>{let e={height:this.offsetHeight,width:this.offsetWidth},o=t.offsetX||this.PRIVATE.offsetPointerPosition.x,i=t.offsetY||this.PRIVATE.offsetPointerPosition.y,r=e.width-o,a=e.height-i,s={x:o,y:i,top:{px:i,pct:this.UTIL.getPercentageDecimal(i,e.height)},right:{px:r,pct:this.UTIL.getPercentageDecimal(r,e.width)},bottom:{px:a,pct:this.UTIL.getPercentageDecimal(a,e.height)},left:{px:o,pct:this.UTIL.getPercentageDecimal(o,e.width)}};return Object.assign({},s,{quadrant:this.PRIVATE.getDropQuadrant(s)})},dragHandler:t=>{let{draggable:e,dimensions:o,lastPointerClientPosition:i}=this.PRIVATE,{client:r}=t.detail.position,a=null,s=null,l={x:r.x>=o.left&&r.x<=o.right,y:r.y>=o.top&&r.y<=o.bottom};null!==i&&(a={top:l.x&&i.y<=o.top&&r.y>o.top,right:l.y&&i.x>=o.right&&r.x<o.right,bottom:l.x&&i.y>=o.bottom&&r.y<o.bottom,left:l.y&&i.x<=o.left&&r.x>o.left},s={top:l.x&&i.y>=o.top&&r.y<o.top,right:l.y&&i.x<=o.right&&r.x>o.right,bottom:l.x&&i.y<=o.bottom&&r.y>o.bottom,left:l.y&&i.x>=o.left&&r.x<o.left}),this.PRIVATE.offsetPointerPosition={x:r.x-o.left,y:r.y-o.top};let n=this.contains(e);if(null!==a&&Object.values(a).some(Boolean)){let e=new CustomEvent("drag.enter",this.PRIVATE.getEventData(t));this.emit(e),n?(this.over=!1,this.PRIVATE.willAcceptDrop=!1):e.defaultPrevented||(this.emit("drop.allow"),this.over=!0,this.PRIVATE.willAcceptDrop=!0)}l.x&&l.y&&(this.over||(this.over=!n,this.emit(`drop.${n?"deny":"allow"}`,{})),this.emit(new CustomEvent("drag.over",this.PRIVATE.getEventData(t)))),null!==s&&Object.values(s).some(Boolean)&&(this.over=!1,this.emit("drop.deny",{}),this.emit(new CustomEvent("drag.leave",this.PRIVATE.getEventData(t)))),this.PRIVATE.lastPointerClientPosition={x:r.x,y:r.y}},getDropQuadrant:t=>{let e="left",o="top";return.5===t.left.pct&&(e="center"),t.left.pct>.5&&(e="right"),.5===t.top.pct&&(o="center"),t.top.pct>.5&&(o="bottom"),`${o} ${e}`},dragendHandler:t=>{let e=new CustomEvent("drop",this.PRIVATE.getEventData(t));this.over&&this.emit(e),e.defaultPrevented&&console.log("PREVENTED"),this.PRIVATE.removeDragHandlers(),this.over=!1,this.offsetPointerPosition=null},removeDragHandlers:()=>{this.PRIVATE.draggable.off("drag",this.PRIVATE.dragHandler),this.PRIVATE.draggable.off("drag.end",this.PRIVATE.dragendHandler)}}),this.UTIL.registerListeners(this,{"handshake.offered":t=>{let{draggable:e,types:o}=t.detail,i=!1;switch(this.mustMatch){case"all":case"*":this.PRIVATE.acceptedTypes.every(t=>o.includes(t))||(i=!0);break;default:this.PRIVATE.acceptedTypes.filter(t=>o.includes(t)).length>=this.mustMatch||(i=!0)}i||(this.emit("handshake.accepted",{dropTarget:this},e),this.PRIVATE.draggable=e,this.PRIVATE.applyDragHandlers())}})}static get observedAttributes(){return["accepts","sortable"]}}return customElements.define("author-drop-target",t),t}();
//# sourceMappingURL=author-drop-target.min.js.map
